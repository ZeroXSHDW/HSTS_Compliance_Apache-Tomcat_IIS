[2026-01-05 09:29:49] [INFO] Starting HSTS patching tests for Unix/Linux...
[2026-01-05 09:29:49] [INFO] Testing scenario: No_HSTS_Header - Configuration with no HSTS header (Tomcat 9.0.50)
[2026-01-05 09:29:49] [INFO] Running audit mode...
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] Tomcat HSTS Configuration Tool
[2026-01-05 09:29:49] Hostname: Admins-MacBook-Pro.local
[2026-01-05 09:29:49] Execution Time: 2026-01-05 09:29:49
[2026-01-05 09:29:49] Mode: audit
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] Checking custom configuration path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49] Found valid Tomcat configuration at custom path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49] Found Tomcat Configuration: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf (Version: 9.0.50)
[2026-01-05 09:29:49] Searching for web.xml files...
[2026-01-05 09:29:49]   Found: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml (global configuration)
[2026-01-05 09:29:49] Found 1 web.xml file(s) to process
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] Processing: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] === AUDIT: No HSTS Configuration Found ===
[2026-01-05 09:29:49] No HSTS headers or filters detected in the configuration file.
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] Configuration Context:
[2026-01-05 09:29:49]   No filters found in configuration
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] === Current HSTS Configuration ===
[2026-01-05 09:29:49]   Status: NOT CONFIGURED
[2026-01-05 09:29:49]   Header: (none)
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] === Available Security Levels ===
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49]   [1] BASIC - Minimum HSTS protection
[2026-01-05 09:29:49]       Header: Strict-Transport-Security: max-age=31536000
[2026-01-05 09:29:49]       Use when: Subdomains should NOT be affected
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49]   [2] HIGH - OWASP Recommended (Default)
[2026-01-05 09:29:49]       Header: Strict-Transport-Security: max-age=31536000; includeSubDomains
[2026-01-05 09:29:49]       Use when: All subdomains also use HTTPS
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49]   [3] VERY HIGH - Preload Ready
[2026-01-05 09:29:49]       Header: Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
[2026-01-05 09:29:49]       Use when: Ready for browser preload list submission
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49]   [4] MAXIMUM - Highest Security
[2026-01-05 09:29:49]       Header: Strict-Transport-Security: max-age=63072000; includeSubDomains; preload
[2026-01-05 09:29:49]       Use when: Maximum protection with 2-year cache
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] === Configure Commands (copy and run) ===
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49]   Option 1: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level basic
[2026-01-05 09:29:49]   Option 2: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level high
[2026-01-05 09:29:49]   Option 3: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level veryhigh
[2026-01-05 09:29:49]   Option 4: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level maximum
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49]   Add --dry-run to preview changes without applying
[2026-01-05 09:29:49] ==========================================
[2026-01-05 09:29:49] FAILURE: No HSTS header definitions found in configuration
[2026-01-05 09:29:49] HSTS configuration needs to be updated.
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] To configure THIS installation, run one of:
[2026-01-05 09:29:49]   Option 1: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level basic --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49]   Option 2: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level high --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49]   Option 3: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level veryhigh --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49]   Option 4: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level maximum --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] Summary
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] Total files processed: 1
[2026-01-05 09:29:49] Successful: 0
[2026-01-05 09:29:49] Failed: 1
[2026-01-05 09:29:49] Overall Status: FAILURE (some files failed)
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] CONFIGURATION COMMANDS FOR FAILED PATHS
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] Copy and run the appropriate command for each installation:
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] --- Installation 1: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf ---
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49]   [1] BASIC (max-age=31536000):
[2026-01-05 09:29:49]       sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 1 --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49]   [2] HIGH - OWASP Recommended (max-age=31536000; includeSubDomains):
[2026-01-05 09:29:49]       sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 2 --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49]   [3] VERY HIGH - Preload Ready (max-age=31536000; includeSubDomains; preload):
[2026-01-05 09:29:49]       sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 3 --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49]   [4] MAXIMUM - Highest Security (max-age=63072000; includeSubDomains; preload):
[2026-01-05 09:29:49]       sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 4 --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] CONFIGURE ALL FAILED PATHS (QUICK FIX)
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] To configure ALL failed installations at once, run ONE of these commands:
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49]   [1] Apply BASIC to ALL:      sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 1
[2026-01-05 09:29:49]   [2] Apply HIGH to ALL:       sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 2
[2026-01-05 09:29:49]   [3] Apply VERY HIGH to ALL:  sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 3
[2026-01-05 09:29:49]   [4] Apply MAXIMUM to ALL:    sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 4
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] TIP: Add --dry-run to preview changes without applying
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] Log file: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/audit.log
[2026-01-05 09:29:49] [WARNING] Audit failed or found issues (this may be expected)
[2026-01-05 09:29:49] [INFO] Running configure mode (dry run)...
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] Tomcat HSTS Configuration Tool
[2026-01-05 09:29:49] Hostname: Admins-MacBook-Pro.local
[2026-01-05 09:29:49] Execution Time: 2026-01-05 09:29:49
[2026-01-05 09:29:49] Mode: configure
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] Checking custom configuration path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49] Found valid Tomcat configuration at custom path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49] Found Tomcat Configuration: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf (Version: 9.0.50)
[2026-01-05 09:29:49] Searching for web.xml files...
[2026-01-05 09:29:49]   Found: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml (global configuration)
[2026-01-05 09:29:49] Found 1 web.xml file(s) to process
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] Processing: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] DRY RUN mode: No changes will be made
[2026-01-05 09:29:49] === AUDIT: No HSTS Configuration Found ===
[2026-01-05 09:29:49] No HSTS headers or filters detected in the configuration file.
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] Configuration Context:
[2026-01-05 09:29:49]   No filters found in configuration
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] === Current HSTS Configuration ===
[2026-01-05 09:29:49]   Status: NOT CONFIGURED
[2026-01-05 09:29:49]   Header: (none)
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] === Available Security Levels ===
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49]   [1] BASIC - Minimum HSTS protection
[2026-01-05 09:29:49]       Header: Strict-Transport-Security: max-age=31536000
[2026-01-05 09:29:49]       Use when: Subdomains should NOT be affected
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49]   [2] HIGH - OWASP Recommended (Default)
[2026-01-05 09:29:49]       Header: Strict-Transport-Security: max-age=31536000; includeSubDomains
[2026-01-05 09:29:49]       Use when: All subdomains also use HTTPS
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49]   [3] VERY HIGH - Preload Ready
[2026-01-05 09:29:49]       Header: Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
[2026-01-05 09:29:49]       Use when: Ready for browser preload list submission
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49]   [4] MAXIMUM - Highest Security
[2026-01-05 09:29:49]       Header: Strict-Transport-Security: max-age=63072000; includeSubDomains; preload
[2026-01-05 09:29:49]       Use when: Maximum protection with 2-year cache
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] === Configure Commands (copy and run) ===
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49]   Option 1: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level basic
[2026-01-05 09:29:49]   Option 2: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level high
[2026-01-05 09:29:49]   Option 3: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level veryhigh
[2026-01-05 09:29:49]   Option 4: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level maximum
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49]   Add --dry-run to preview changes without applying
[2026-01-05 09:29:49] ==========================================
[2026-01-05 09:29:49] Current state: No HSTS header definitions found in configuration
[2026-01-05 09:29:49] Configuration required: Ensuring exactly one compliant HSTS definition exists
[2026-01-05 09:29:49] Backup created: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_092949
[2026-01-05 09:29:49] DRY RUN: Would apply compliant HSTS configuration (see diff below)
--- /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml	2026-01-05 09:29:49
+++ /var/folders/8x/q59p0_c17g9czgrcs5t5yyd80000gn/T/tmp.0nPZKWx2Gq	2026-01-05 09:29:49
@@ -5,4 +5,20 @@
          http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"
          version="4.0">
     <display-name>Test Application</display-name>
+    <filter>
+        <filter-name>HstsHeaderFilter</filter-name>
+        <filter-class>org.apache.catalina.filters.HttpHeaderSecurityFilter</filter-class>
+        <init-param>
+            <param-name>hstsMaxAgeSeconds</param-name>
+            <param-value>31536000</param-value>
+        </init-param>
+        <init-param>
+            <param-name>hstsIncludeSubDomains</param-name>
+            <param-value>true</param-value>
+        </init-param>
+    </filter>
+    <filter-mapping>
+        <filter-name>HstsHeaderFilter</filter-name>
+        <url-pattern>/*</url-pattern>
+    </filter-mapping>
 </web-app>
[2026-01-05 09:29:49] SUCCESS: DRY RUN: Would apply compliant HSTS configuration (see diff below)
[2026-01-05 09:29:49] Backup available at: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_092949
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] Summary
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] Total files processed: 1
[2026-01-05 09:29:49] Successful: 1
[2026-01-05 09:29:49] Failed: 0
[2026-01-05 09:29:49] Overall Status: SUCCESS
[2026-01-05 09:29:49] Log file: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/dry_run.log
[2026-01-05 09:29:49] [INFO] Dry run completed successfully
[2026-01-05 09:29:49] [INFO] Testing scenario: Non_Compliant_HSTS_Short_MaxAge - HSTS with max-age less than 31536000 (Tomcat 9.0.50)
[2026-01-05 09:29:49] [INFO] Running audit mode...
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] Tomcat HSTS Configuration Tool
[2026-01-05 09:29:49] Hostname: Admins-MacBook-Pro.local
[2026-01-05 09:29:49] Execution Time: 2026-01-05 09:29:49
[2026-01-05 09:29:49] Mode: audit
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] Checking custom configuration path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49] Found valid Tomcat configuration at custom path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49] Found Tomcat Configuration: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf (Version: 9.0.50)
[2026-01-05 09:29:49] Searching for web.xml files...
[2026-01-05 09:29:49]   Found: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml (global configuration)
[2026-01-05 09:29:49] Found 1 web.xml file(s) to process
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] Processing: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] Found 5 HSTS header definition(s)
[2026-01-05 09:29:49] === Current Filter-Based HSTS Configuration ===
[2026-01-05 09:29:49]   hstsMaxAgeSeconds: 86400
[2026-01-05 09:29:49]   hstsIncludeSubDomains: true
[2026-01-05 09:29:49] ===============================================
[2026-01-05 09:29:49] === Audit Result Breakdown ===
[2026-01-05 09:29:49]   [FAIL] Filter-based HSTS (Target Level: high): max-age=86400; includeSubDomains=true; preload=false
[2026-01-05 09:29:49] ==============================
[2026-01-05 09:29:49] FAILURE: Non-compliant HSTS configuration found: 1 failed issues.
[2026-01-05 09:29:49] HSTS configuration needs to be updated.
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] To configure THIS installation, run one of:
[2026-01-05 09:29:49]   Option 1: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level basic --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49]   Option 2: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level high --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49]   Option 3: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level veryhigh --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49]   Option 4: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level maximum --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] Summary
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] Total files processed: 1
[2026-01-05 09:29:49] Successful: 0
[2026-01-05 09:29:49] Failed: 1
[2026-01-05 09:29:49] Overall Status: FAILURE (some files failed)
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] CONFIGURATION COMMANDS FOR FAILED PATHS
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] Copy and run the appropriate command for each installation:
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] --- Installation 1: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf ---
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49]   [1] BASIC (max-age=31536000):
[2026-01-05 09:29:49]       sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 1 --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49]   [2] HIGH - OWASP Recommended (max-age=31536000; includeSubDomains):
[2026-01-05 09:29:49]       sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 2 --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49]   [3] VERY HIGH - Preload Ready (max-age=31536000; includeSubDomains; preload):
[2026-01-05 09:29:49]       sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 3 --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49]   [4] MAXIMUM - Highest Security (max-age=63072000; includeSubDomains; preload):
[2026-01-05 09:29:49]       sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 4 --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] CONFIGURE ALL FAILED PATHS (QUICK FIX)
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] To configure ALL failed installations at once, run ONE of these commands:
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49]   [1] Apply BASIC to ALL:      sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 1
[2026-01-05 09:29:49]   [2] Apply HIGH to ALL:       sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 2
[2026-01-05 09:29:49]   [3] Apply VERY HIGH to ALL:  sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 3
[2026-01-05 09:29:49]   [4] Apply MAXIMUM to ALL:    sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 4
[2026-01-05 09:29:49] 
[2026-01-05 09:29:49] TIP: Add --dry-run to preview changes without applying
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] Log file: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/audit.log
[2026-01-05 09:29:49] [WARNING] Audit failed or found issues (this may be expected)
[2026-01-05 09:29:49] [INFO] Running configure mode (dry run)...
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] Tomcat HSTS Configuration Tool
[2026-01-05 09:29:49] Hostname: Admins-MacBook-Pro.local
[2026-01-05 09:29:49] Execution Time: 2026-01-05 09:29:49
[2026-01-05 09:29:49] Mode: configure
[2026-01-05 09:29:49] =========================================
[2026-01-05 09:29:49] Checking custom configuration path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49] Found valid Tomcat configuration at custom path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:49] Found Tomcat Configuration: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf (Version: 9.0.50)
[2026-01-05 09:29:50] Searching for web.xml files...
[2026-01-05 09:29:50]   Found: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml (global configuration)
[2026-01-05 09:29:50] Found 1 web.xml file(s) to process
[2026-01-05 09:29:50] 
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] Processing: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] DRY RUN mode: No changes will be made
[2026-01-05 09:29:50] Found 5 HSTS header definition(s)
[2026-01-05 09:29:50] === Current Filter-Based HSTS Configuration ===
[2026-01-05 09:29:50]   hstsMaxAgeSeconds: 86400
[2026-01-05 09:29:50]   hstsIncludeSubDomains: true
[2026-01-05 09:29:50] ===============================================
[2026-01-05 09:29:50] === Audit Result Breakdown ===
[2026-01-05 09:29:50]   [FAIL] Filter-based HSTS (Target Level: high): max-age=86400; includeSubDomains=true; preload=false
[2026-01-05 09:29:50] ==============================
[2026-01-05 09:29:50] Current state: Non-compliant HSTS configuration found: 1 failed issues.
[2026-01-05 09:29:50] Configuration required: Ensuring exactly one compliant HSTS definition exists
[2026-01-05 09:29:50] Backup created: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_092950
[2026-01-05 09:29:50] DRY RUN: Would apply compliant HSTS configuration (see diff below)
--- /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml	2026-01-05 09:29:49
+++ /var/folders/8x/q59p0_c17g9czgrcs5t5yyd80000gn/T/tmp.83Kra3AP3j	2026-01-05 09:29:50
@@ -9,7 +9,7 @@
         <filter-class>org.apache.catalina.filters.HttpHeaderSecurityFilter</filter-class>
         <init-param>
             <param-name>hstsMaxAgeSeconds</param-name>
-            <param-value>86400</param-value>
+            <param-value>31536000</param-value>
         </init-param>
         <init-param>
             <param-name>hstsIncludeSubDomains</param-name>
[2026-01-05 09:29:50] SUCCESS: DRY RUN: Would apply compliant HSTS configuration (see diff below)
[2026-01-05 09:29:50] Backup available at: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_092950
[2026-01-05 09:29:50] 
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] Summary
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] Total files processed: 1
[2026-01-05 09:29:50] Successful: 1
[2026-01-05 09:29:50] Failed: 0
[2026-01-05 09:29:50] Overall Status: SUCCESS
[2026-01-05 09:29:50] Log file: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/dry_run.log
[2026-01-05 09:29:50] [INFO] Dry run completed successfully
[2026-01-05 09:29:50] [INFO] Testing scenario: Non_Compliant_HSTS_No_IncludeSubDomains - HSTS with max-age correct but missing includeSubDomains (Tomcat 9.0.50)
[2026-01-05 09:29:50] [INFO] Running audit mode...
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] Tomcat HSTS Configuration Tool
[2026-01-05 09:29:50] Hostname: Admins-MacBook-Pro.local
[2026-01-05 09:29:50] Execution Time: 2026-01-05 09:29:50
[2026-01-05 09:29:50] Mode: audit
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] Checking custom configuration path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:50] Found valid Tomcat configuration at custom path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:50] Found Tomcat Configuration: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf (Version: 9.0.50)
[2026-01-05 09:29:50] Searching for web.xml files...
[2026-01-05 09:29:50]   Found: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml (global configuration)
[2026-01-05 09:29:50] Found 1 web.xml file(s) to process
[2026-01-05 09:29:50] 
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] Processing: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] Found 5 HSTS header definition(s)
[2026-01-05 09:29:50] === Current Filter-Based HSTS Configuration ===
[2026-01-05 09:29:50]   hstsMaxAgeSeconds: 31536000
[2026-01-05 09:29:50]   hstsIncludeSubDomains: false
[2026-01-05 09:29:50] ===============================================
[2026-01-05 09:29:50] === Audit Result Breakdown ===
[2026-01-05 09:29:50]   [FAIL] Filter-based HSTS (Target Level: high): max-age=31536000; includeSubDomains=false; preload=false
[2026-01-05 09:29:50] ==============================
[2026-01-05 09:29:50] FAILURE: Non-compliant HSTS configuration found: 1 failed issues.
[2026-01-05 09:29:50] HSTS configuration needs to be updated.
[2026-01-05 09:29:50] 
[2026-01-05 09:29:50] To configure THIS installation, run one of:
[2026-01-05 09:29:50]   Option 1: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level basic --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:50]   Option 2: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level high --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:50]   Option 3: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level veryhigh --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:50]   Option 4: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level maximum --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:50] 
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] Summary
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] Total files processed: 1
[2026-01-05 09:29:50] Successful: 0
[2026-01-05 09:29:50] Failed: 1
[2026-01-05 09:29:50] Overall Status: FAILURE (some files failed)
[2026-01-05 09:29:50] 
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] CONFIGURATION COMMANDS FOR FAILED PATHS
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] 
[2026-01-05 09:29:50] Copy and run the appropriate command for each installation:
[2026-01-05 09:29:50] 
[2026-01-05 09:29:50] --- Installation 1: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf ---
[2026-01-05 09:29:50] 
[2026-01-05 09:29:50]   [1] BASIC (max-age=31536000):
[2026-01-05 09:29:50]       sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 1 --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:50] 
[2026-01-05 09:29:50]   [2] HIGH - OWASP Recommended (max-age=31536000; includeSubDomains):
[2026-01-05 09:29:50]       sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 2 --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:50] 
[2026-01-05 09:29:50]   [3] VERY HIGH - Preload Ready (max-age=31536000; includeSubDomains; preload):
[2026-01-05 09:29:50]       sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 3 --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:50] 
[2026-01-05 09:29:50]   [4] MAXIMUM - Highest Security (max-age=63072000; includeSubDomains; preload):
[2026-01-05 09:29:50]       sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 4 --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:50] 
[2026-01-05 09:29:50] 
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] CONFIGURE ALL FAILED PATHS (QUICK FIX)
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] 
[2026-01-05 09:29:50] To configure ALL failed installations at once, run ONE of these commands:
[2026-01-05 09:29:50] 
[2026-01-05 09:29:50]   [1] Apply BASIC to ALL:      sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 1
[2026-01-05 09:29:50]   [2] Apply HIGH to ALL:       sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 2
[2026-01-05 09:29:50]   [3] Apply VERY HIGH to ALL:  sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 3
[2026-01-05 09:29:50]   [4] Apply MAXIMUM to ALL:    sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 4
[2026-01-05 09:29:50] 
[2026-01-05 09:29:50] TIP: Add --dry-run to preview changes without applying
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] Log file: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/audit.log
[2026-01-05 09:29:50] [WARNING] Audit failed or found issues (this may be expected)
[2026-01-05 09:29:50] [INFO] Running configure mode (dry run)...
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] Tomcat HSTS Configuration Tool
[2026-01-05 09:29:50] Hostname: Admins-MacBook-Pro.local
[2026-01-05 09:29:50] Execution Time: 2026-01-05 09:29:50
[2026-01-05 09:29:50] Mode: configure
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] Checking custom configuration path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:50] Found valid Tomcat configuration at custom path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:50] Found Tomcat Configuration: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf (Version: 9.0.50)
[2026-01-05 09:29:50] Searching for web.xml files...
[2026-01-05 09:29:50]   Found: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml (global configuration)
[2026-01-05 09:29:50] Found 1 web.xml file(s) to process
[2026-01-05 09:29:50] 
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] Processing: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] DRY RUN mode: No changes will be made
[2026-01-05 09:29:50] Found 5 HSTS header definition(s)
[2026-01-05 09:29:50] === Current Filter-Based HSTS Configuration ===
[2026-01-05 09:29:50]   hstsMaxAgeSeconds: 31536000
[2026-01-05 09:29:50]   hstsIncludeSubDomains: false
[2026-01-05 09:29:50] ===============================================
[2026-01-05 09:29:50] === Audit Result Breakdown ===
[2026-01-05 09:29:50]   [FAIL] Filter-based HSTS (Target Level: high): max-age=31536000; includeSubDomains=false; preload=false
[2026-01-05 09:29:50] ==============================
[2026-01-05 09:29:50] Current state: Non-compliant HSTS configuration found: 1 failed issues.
[2026-01-05 09:29:50] Configuration required: Ensuring exactly one compliant HSTS definition exists
[2026-01-05 09:29:50] Backup created: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_092950
[2026-01-05 09:29:50] DRY RUN: Would apply compliant HSTS configuration (see diff below)
--- /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml	2026-01-05 09:29:50
+++ /var/folders/8x/q59p0_c17g9czgrcs5t5yyd80000gn/T/tmp.fEzHDVLbVE	2026-01-05 09:29:50
@@ -13,7 +13,7 @@
         </init-param>
         <init-param>
             <param-name>hstsIncludeSubDomains</param-name>
-            <param-value>false</param-value>
+            <param-value>true</param-value>
         </init-param>
     </filter>
     <filter-mapping>
[2026-01-05 09:29:50] SUCCESS: DRY RUN: Would apply compliant HSTS configuration (see diff below)
[2026-01-05 09:29:50] Backup available at: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_092950
[2026-01-05 09:29:50] 
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] Summary
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] Total files processed: 1
[2026-01-05 09:29:50] Successful: 1
[2026-01-05 09:29:50] Failed: 0
[2026-01-05 09:29:50] Overall Status: SUCCESS
[2026-01-05 09:29:50] Log file: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/dry_run.log
[2026-01-05 09:29:50] [INFO] Dry run completed successfully
[2026-01-05 09:29:50] [INFO] Testing scenario: Compliant_HSTS - Already compliant HSTS configuration (Tomcat 9.0.50)
[2026-01-05 09:29:50] [INFO] Running audit mode...
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] Tomcat HSTS Configuration Tool
[2026-01-05 09:29:50] Hostname: Admins-MacBook-Pro.local
[2026-01-05 09:29:50] Execution Time: 2026-01-05 09:29:50
[2026-01-05 09:29:50] Mode: audit
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] Checking custom configuration path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:50] Found valid Tomcat configuration at custom path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:50] Found Tomcat Configuration: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf (Version: 9.0.50)
[2026-01-05 09:29:50] Searching for web.xml files...
[2026-01-05 09:29:50]   Found: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml (global configuration)
[2026-01-05 09:29:50] Found 1 web.xml file(s) to process
[2026-01-05 09:29:50] 
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:50] Processing: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml
[2026-01-05 09:29:50] =========================================
[2026-01-05 09:29:51] Found 5 HSTS header definition(s)
[2026-01-05 09:29:51] === Current Filter-Based HSTS Configuration ===
[2026-01-05 09:29:51]   hstsMaxAgeSeconds: 31536000
[2026-01-05 09:29:51]   hstsIncludeSubDomains: true
[2026-01-05 09:29:51] ===============================================
[2026-01-05 09:29:51] === Audit Result Breakdown ===
[2026-01-05 09:29:51]   [PASS] Filter-based HSTS (Level: high): max-age=31536000; includeSubDomains=true; preload=false
[2026-01-05 09:29:51] ==============================
[2026-01-05 09:29:51] SUCCESS: HSTS is correctly configured with exactly one compliant definition.
[2026-01-05 09:29:51] HSTS configuration is compliant.
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] Summary
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] Total files processed: 1
[2026-01-05 09:29:51] Successful: 1
[2026-01-05 09:29:51] Failed: 0
[2026-01-05 09:29:51] Overall Status: SUCCESS
[2026-01-05 09:29:51] Log file: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/audit.log
[2026-01-05 09:29:51] [INFO] Audit completed successfully
[2026-01-05 09:29:51] [INFO] Running configure mode (dry run)...
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] Tomcat HSTS Configuration Tool
[2026-01-05 09:29:51] Hostname: Admins-MacBook-Pro.local
[2026-01-05 09:29:51] Execution Time: 2026-01-05 09:29:51
[2026-01-05 09:29:51] Mode: configure
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] Checking custom configuration path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:51] Found valid Tomcat configuration at custom path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:51] Found Tomcat Configuration: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf (Version: 9.0.50)
[2026-01-05 09:29:51] Searching for web.xml files...
[2026-01-05 09:29:51]   Found: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml (global configuration)
[2026-01-05 09:29:51] Found 1 web.xml file(s) to process
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] Processing: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] DRY RUN mode: No changes will be made
[2026-01-05 09:29:51] Found 5 HSTS header definition(s)
[2026-01-05 09:29:51] === Current Filter-Based HSTS Configuration ===
[2026-01-05 09:29:51]   hstsMaxAgeSeconds: 31536000
[2026-01-05 09:29:51]   hstsIncludeSubDomains: true
[2026-01-05 09:29:51] ===============================================
[2026-01-05 09:29:51] === Audit Result Breakdown ===
[2026-01-05 09:29:51]   [PASS] Filter-based HSTS (Level: high): max-age=31536000; includeSubDomains=true; preload=false
[2026-01-05 09:29:51] ==============================
[2026-01-05 09:29:51] Current state: HSTS is correctly configured with exactly one compliant definition.
[2026-01-05 09:29:51] SUCCESS: HSTS is already correctly configured with exactly one compliant definition
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] Summary
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] Total files processed: 1
[2026-01-05 09:29:51] Successful: 1
[2026-01-05 09:29:51] Failed: 0
[2026-01-05 09:29:51] Overall Status: SUCCESS
[2026-01-05 09:29:51] Log file: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/dry_run.log
[2026-01-05 09:29:51] [INFO] Dry run completed successfully
[2026-01-05 09:29:51] [INFO] Testing scenario: Tomcat_11_Jakarta - Tomcat 11 with jakarta.ee namespace (Tomcat 11.0.0)
[2026-01-05 09:29:51] [INFO] Running audit mode...
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] Tomcat HSTS Configuration Tool
[2026-01-05 09:29:51] Hostname: Admins-MacBook-Pro.local
[2026-01-05 09:29:51] Execution Time: 2026-01-05 09:29:51
[2026-01-05 09:29:51] Mode: audit
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] Checking custom configuration path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:51] Found valid Tomcat configuration at custom path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:51] Found Tomcat Configuration: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf (Version: 11.0.0)
[2026-01-05 09:29:51] Searching for web.xml files...
[2026-01-05 09:29:51]   Found: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml (global configuration)
[2026-01-05 09:29:51] Found 1 web.xml file(s) to process
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] Processing: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] === AUDIT: No HSTS Configuration Found ===
[2026-01-05 09:29:51] No HSTS headers or filters detected in the configuration file.
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] Configuration Context:
[2026-01-05 09:29:51]   No filters found in configuration
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] === Current HSTS Configuration ===
[2026-01-05 09:29:51]   Status: NOT CONFIGURED
[2026-01-05 09:29:51]   Header: (none)
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] === Available Security Levels ===
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51]   [1] BASIC - Minimum HSTS protection
[2026-01-05 09:29:51]       Header: Strict-Transport-Security: max-age=31536000
[2026-01-05 09:29:51]       Use when: Subdomains should NOT be affected
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51]   [2] HIGH - OWASP Recommended (Default)
[2026-01-05 09:29:51]       Header: Strict-Transport-Security: max-age=31536000; includeSubDomains
[2026-01-05 09:29:51]       Use when: All subdomains also use HTTPS
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51]   [3] VERY HIGH - Preload Ready
[2026-01-05 09:29:51]       Header: Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
[2026-01-05 09:29:51]       Use when: Ready for browser preload list submission
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51]   [4] MAXIMUM - Highest Security
[2026-01-05 09:29:51]       Header: Strict-Transport-Security: max-age=63072000; includeSubDomains; preload
[2026-01-05 09:29:51]       Use when: Maximum protection with 2-year cache
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] === Configure Commands (copy and run) ===
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51]   Option 1: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level basic
[2026-01-05 09:29:51]   Option 2: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level high
[2026-01-05 09:29:51]   Option 3: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level veryhigh
[2026-01-05 09:29:51]   Option 4: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level maximum
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51]   Add --dry-run to preview changes without applying
[2026-01-05 09:29:51] ==========================================
[2026-01-05 09:29:51] FAILURE: No HSTS header definitions found in configuration
[2026-01-05 09:29:51] HSTS configuration needs to be updated.
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] To configure THIS installation, run one of:
[2026-01-05 09:29:51]   Option 1: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level basic --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:51]   Option 2: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level high --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:51]   Option 3: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level veryhigh --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:51]   Option 4: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level maximum --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] Summary
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] Total files processed: 1
[2026-01-05 09:29:51] Successful: 0
[2026-01-05 09:29:51] Failed: 1
[2026-01-05 09:29:51] Overall Status: FAILURE (some files failed)
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] CONFIGURATION COMMANDS FOR FAILED PATHS
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] Copy and run the appropriate command for each installation:
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] --- Installation 1: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf ---
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51]   [1] BASIC (max-age=31536000):
[2026-01-05 09:29:51]       sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 1 --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51]   [2] HIGH - OWASP Recommended (max-age=31536000; includeSubDomains):
[2026-01-05 09:29:51]       sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 2 --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51]   [3] VERY HIGH - Preload Ready (max-age=31536000; includeSubDomains; preload):
[2026-01-05 09:29:51]       sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 3 --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51]   [4] MAXIMUM - Highest Security (max-age=63072000; includeSubDomains; preload):
[2026-01-05 09:29:51]       sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 4 --custom-conf=/Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] CONFIGURE ALL FAILED PATHS (QUICK FIX)
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] To configure ALL failed installations at once, run ONE of these commands:
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51]   [1] Apply BASIC to ALL:      sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 1
[2026-01-05 09:29:51]   [2] Apply HIGH to ALL:       sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 2
[2026-01-05 09:29:51]   [3] Apply VERY HIGH to ALL:  sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 3
[2026-01-05 09:29:51]   [4] Apply MAXIMUM to ALL:    sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level 4
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] TIP: Add --dry-run to preview changes without applying
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] Log file: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/audit.log
[2026-01-05 09:29:51] [WARNING] Audit failed or found issues (this may be expected)
[2026-01-05 09:29:51] [INFO] Running configure mode (dry run)...
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] Tomcat HSTS Configuration Tool
[2026-01-05 09:29:51] Hostname: Admins-MacBook-Pro.local
[2026-01-05 09:29:51] Execution Time: 2026-01-05 09:29:51
[2026-01-05 09:29:51] Mode: configure
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] Checking custom configuration path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:51] Found valid Tomcat configuration at custom path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 09:29:51] Found Tomcat Configuration: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf (Version: 11.0.0)
[2026-01-05 09:29:51] Searching for web.xml files...
[2026-01-05 09:29:51]   Found: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml (global configuration)
[2026-01-05 09:29:51] Found 1 web.xml file(s) to process
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] Processing: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] DRY RUN mode: No changes will be made
[2026-01-05 09:29:51] === AUDIT: No HSTS Configuration Found ===
[2026-01-05 09:29:51] No HSTS headers or filters detected in the configuration file.
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] Configuration Context:
[2026-01-05 09:29:51]   No filters found in configuration
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] === Current HSTS Configuration ===
[2026-01-05 09:29:51]   Status: NOT CONFIGURED
[2026-01-05 09:29:51]   Header: (none)
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] === Available Security Levels ===
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51]   [1] BASIC - Minimum HSTS protection
[2026-01-05 09:29:51]       Header: Strict-Transport-Security: max-age=31536000
[2026-01-05 09:29:51]       Use when: Subdomains should NOT be affected
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51]   [2] HIGH - OWASP Recommended (Default)
[2026-01-05 09:29:51]       Header: Strict-Transport-Security: max-age=31536000; includeSubDomains
[2026-01-05 09:29:51]       Use when: All subdomains also use HTTPS
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51]   [3] VERY HIGH - Preload Ready
[2026-01-05 09:29:51]       Header: Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
[2026-01-05 09:29:51]       Use when: Ready for browser preload list submission
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51]   [4] MAXIMUM - Highest Security
[2026-01-05 09:29:51]       Header: Strict-Transport-Security: max-age=63072000; includeSubDomains; preload
[2026-01-05 09:29:51]       Use when: Maximum protection with 2-year cache
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] === Configure Commands (copy and run) ===
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51]   Option 1: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level basic
[2026-01-05 09:29:51]   Option 2: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level high
[2026-01-05 09:29:51]   Option 3: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level veryhigh
[2026-01-05 09:29:51]   Option 4: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level maximum
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51]   Add --dry-run to preview changes without applying
[2026-01-05 09:29:51] ==========================================
[2026-01-05 09:29:51] Current state: No HSTS header definitions found in configuration
[2026-01-05 09:29:51] Configuration required: Ensuring exactly one compliant HSTS definition exists
[2026-01-05 09:29:51] Backup created: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_092951
[2026-01-05 09:29:51] DRY RUN: Would apply compliant HSTS configuration (see diff below)
--- /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml	2026-01-05 09:29:51
+++ /var/folders/8x/q59p0_c17g9czgrcs5t5yyd80000gn/T/tmp.6PZXwDki5i	2026-01-05 09:29:51
@@ -5,4 +5,20 @@
          https://jakarta.ee/xml/ns/jakartaee/web-app_5_0.xsd"
          version="5.0">
     <display-name>Jakarta Test App</display-name>
+    <filter>
+        <filter-name>HstsHeaderFilter</filter-name>
+        <filter-class>org.apache.catalina.filters.HttpHeaderSecurityFilter</filter-class>
+        <init-param>
+            <param-name>hstsMaxAgeSeconds</param-name>
+            <param-value>31536000</param-value>
+        </init-param>
+        <init-param>
+            <param-name>hstsIncludeSubDomains</param-name>
+            <param-value>true</param-value>
+        </init-param>
+    </filter>
+    <filter-mapping>
+        <filter-name>HstsHeaderFilter</filter-name>
+        <url-pattern>/*</url-pattern>
+    </filter-mapping>
 </web-app>
[2026-01-05 09:29:51] SUCCESS: DRY RUN: Would apply compliant HSTS configuration (see diff below)
[2026-01-05 09:29:51] Backup available at: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_092951
[2026-01-05 09:29:51] 
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] Summary
[2026-01-05 09:29:51] =========================================
[2026-01-05 09:29:51] Total files processed: 1
[2026-01-05 09:29:51] Successful: 1
[2026-01-05 09:29:51] Failed: 0
[2026-01-05 09:29:51] Overall Status: SUCCESS
[2026-01-05 09:29:51] Log file: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/dry_run.log
[2026-01-05 09:29:51] [INFO] Dry run completed successfully
[2026-01-05 09:29:51] [INFO] Testing scenario: JSON_Reporting - Verify JSON output format
[2026-01-05 09:29:51] [INFO] Running with --json flag...
[2026-01-05 09:29:52] [INFO] JSON output format verified successfully
[2026-01-05 09:29:52] [INFO] JSON Content: {"hostname":"Admins-MacBook-Pro.local","os":"Darwin 24.3.0","timestamp":"2026-01-05 09:29:51","mode":"audit","total_processed":1,"success_count":0,"failure_count":1,"overall_status":"FAILURE"}
[2026-01-05 09:29:52] [INFO] === All HSTS tests completed ===
[2026-01-05 09:29:52] [INFO] Test log saved to: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/TestHstsUnix.log
[2026-01-05 09:29:52] [INFO] Test files saved to: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest
[2026-01-05 09:29:52] [INFO] Backups saved to: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTestBackup
[2026-01-05 11:41:46] [INFO] Starting HSTS patching tests for Unix/Linux...
[2026-01-05 11:41:46] [INFO] Testing scenario: No_HSTS_Header - Configuration with no HSTS header (Tomcat 9.0.50)
[2026-01-05 11:41:46] [INFO] Running audit mode...
Checking Tomcat HSTS Configuration...
############################Admins-MacBook-Pro.local############################
Execution Time: 2026-01-05 11:41:46
HOSTNAME: Admins-MacBook-Pro.local
===========================

HSTS Compliance Results:
File                                     | Status          | Details
-----------------------------------------+-----------------+-----------------------------------------
web.xml                                  | Not Configured  | No HSTS filters found

===========================
Overall Status: Non-Compliant (0 Compliant, 0 Non-Compliant, 1 Not Configured)
Audit completed. Log: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/audit.log
[2026-01-05 11:41:46] [WARNING] Audit failed or found issues (this may be expected)
[2026-01-05 11:41:46] [INFO] Running configure mode (dry run)...
[2026-01-05 11:41:46] =========================================
[2026-01-05 11:41:46] Tomcat HSTS Configuration Tool
[2026-01-05 11:41:46] Hostname: Admins-MacBook-Pro.local
[2026-01-05 11:41:46] Execution Time: 2026-01-05 11:41:46
[2026-01-05 11:41:46] Mode: configure
[2026-01-05 11:41:46] =========================================
[2026-01-05 11:41:46] Checking custom configuration path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 11:41:46] Found valid Tomcat configuration at custom path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 11:41:46] Found Tomcat Configuration: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf (Version: 9.0.50)
[2026-01-05 11:41:46] Searching for web.xml files...
[2026-01-05 11:41:46]   Found: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml (global configuration)
[2026-01-05 11:41:46] Found 1 web.xml file(s) to process
[2026-01-05 11:41:46] 
[2026-01-05 11:41:46] =========================================
[2026-01-05 11:41:46] Processing: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml
[2026-01-05 11:41:46] =========================================
[2026-01-05 11:41:46] DRY RUN mode: No changes will be made
[2026-01-05 11:41:46] === AUDIT: No HSTS Configuration Found ===
[2026-01-05 11:41:46] No HSTS headers or filters detected in the configuration file.
[2026-01-05 11:41:46] 
[2026-01-05 11:41:46] Configuration Context:
[2026-01-05 11:41:46]   No filters found in configuration
[2026-01-05 11:41:46] 
[2026-01-05 11:41:46] === Current HSTS Configuration ===
[2026-01-05 11:41:46]   Status: NOT CONFIGURED
[2026-01-05 11:41:46]   Header: (none)
[2026-01-05 11:41:46] 
[2026-01-05 11:41:46] === Available Security Levels ===
[2026-01-05 11:41:46] 
[2026-01-05 11:41:46]   [1] BASIC - Minimum HSTS protection
[2026-01-05 11:41:46]       Header: Strict-Transport-Security: max-age=31536000
[2026-01-05 11:41:46]       Use when: Subdomains should NOT be affected
[2026-01-05 11:41:46] 
[2026-01-05 11:41:46]   [2] HIGH - OWASP Recommended (Default)
[2026-01-05 11:41:46]       Header: Strict-Transport-Security: max-age=31536000; includeSubDomains
[2026-01-05 11:41:46]       Use when: All subdomains also use HTTPS
[2026-01-05 11:41:46] 
[2026-01-05 11:41:46]   [3] VERY HIGH - Preload Ready
[2026-01-05 11:41:46]       Header: Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
[2026-01-05 11:41:46]       Use when: Ready for browser preload list submission
[2026-01-05 11:41:46] 
[2026-01-05 11:41:46]   [4] MAXIMUM - Highest Security
[2026-01-05 11:41:46]       Header: Strict-Transport-Security: max-age=63072000; includeSubDomains; preload
[2026-01-05 11:41:46]       Use when: Maximum protection with 2-year cache
[2026-01-05 11:41:46] 
[2026-01-05 11:41:46] === Configure Commands (copy and run) ===
[2026-01-05 11:41:46] 
[2026-01-05 11:41:46]   Option 1: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level basic
[2026-01-05 11:41:46]   Option 2: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level high
[2026-01-05 11:41:46]   Option 3: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level veryhigh
[2026-01-05 11:41:46]   Option 4: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level maximum
[2026-01-05 11:41:46] 
[2026-01-05 11:41:46]   Add --dry-run to preview changes without applying
[2026-01-05 11:41:46] ==========================================
[2026-01-05 11:41:46] Current state: No HSTS header definitions found in configuration
[2026-01-05 11:41:46] Configuration required: Ensuring exactly one compliant HSTS definition exists
[2026-01-05 11:41:46] Backup created: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_114146
[2026-01-05 11:41:46] DRY RUN: Would apply compliant HSTS configuration (see diff below)
--- /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml	2026-01-05 11:41:46
+++ /var/folders/8x/q59p0_c17g9czgrcs5t5yyd80000gn/T/tmp.cwKw4algBN	2026-01-05 11:41:46
@@ -5,4 +5,20 @@
          http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"
          version="4.0">
     <display-name>Test Application</display-name>
+    <filter>
+        <filter-name>HstsHeaderFilter</filter-name>
+        <filter-class>org.apache.catalina.filters.HttpHeaderSecurityFilter</filter-class>
+        <init-param>
+            <param-name>hstsMaxAgeSeconds</param-name>
+            <param-value>31536000</param-value>
+        </init-param>
+        <init-param>
+            <param-name>hstsIncludeSubDomains</param-name>
+            <param-value>true</param-value>
+        </init-param>
+    </filter>
+    <filter-mapping>
+        <filter-name>HstsHeaderFilter</filter-name>
+        <url-pattern>/*</url-pattern>
+    </filter-mapping>
 </web-app>
[2026-01-05 11:41:46] SUCCESS: DRY RUN: Would apply compliant HSTS configuration (see diff below)
[2026-01-05 11:41:46] Backup available at: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_114146
[2026-01-05 11:41:46] 
[2026-01-05 11:41:46] =========================================
[2026-01-05 11:41:46] Summary
[2026-01-05 11:41:46] =========================================
[2026-01-05 11:41:46] Total files processed: 1
[2026-01-05 11:41:46] Successful: 1
[2026-01-05 11:41:46] Failed: 0
[2026-01-05 11:41:46] Overall Status: SUCCESS
[2026-01-05 11:41:46] Log file: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/dry_run.log
[2026-01-05 11:41:46] [INFO] Dry run completed successfully
[2026-01-05 11:41:46] [INFO] Testing scenario: Non_Compliant_HSTS_Short_MaxAge - HSTS with max-age less than 31536000 (Tomcat 9.0.50)
[2026-01-05 11:41:46] [INFO] Running audit mode...
Checking Tomcat HSTS Configuration...
############################Admins-MacBook-Pro.local############################
Execution Time: 2026-01-05 11:41:46
HOSTNAME: Admins-MacBook-Pro.local
===========================

HSTS Compliance Results:
File                                     | Status          | Details
-----------------------------------------+-----------------+-----------------------------------------
web.xml                                  | Non-Compliant   | max-age=86400, includeSubDomains=true

===========================
Overall Status: Non-Compliant (0 Compliant, 1 Non-Compliant, 0 Not Configured)
Audit completed. Log: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/audit.log
[2026-01-05 11:41:46] [WARNING] Audit failed or found issues (this may be expected)
[2026-01-05 11:41:46] [INFO] Running configure mode (dry run)...
[2026-01-05 11:41:46] =========================================
[2026-01-05 11:41:46] Tomcat HSTS Configuration Tool
[2026-01-05 11:41:46] Hostname: Admins-MacBook-Pro.local
[2026-01-05 11:41:46] Execution Time: 2026-01-05 11:41:46
[2026-01-05 11:41:46] Mode: configure
[2026-01-05 11:41:46] =========================================
[2026-01-05 11:41:46] Checking custom configuration path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 11:41:46] Found valid Tomcat configuration at custom path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 11:41:46] Found Tomcat Configuration: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf (Version: 9.0.50)
[2026-01-05 11:41:46] Searching for web.xml files...
[2026-01-05 11:41:46]   Found: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml (global configuration)
[2026-01-05 11:41:46] Found 1 web.xml file(s) to process
[2026-01-05 11:41:46] 
[2026-01-05 11:41:46] =========================================
[2026-01-05 11:41:46] Processing: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml
[2026-01-05 11:41:46] =========================================
[2026-01-05 11:41:46] DRY RUN mode: No changes will be made
[2026-01-05 11:41:47] Found 5 HSTS header definition(s)
[2026-01-05 11:41:47] === Current Filter-Based HSTS Configuration ===
[2026-01-05 11:41:47]   hstsMaxAgeSeconds: 86400
[2026-01-05 11:41:47]   hstsIncludeSubDomains: true
[2026-01-05 11:41:47] ===============================================
[2026-01-05 11:41:47] === Audit Result Breakdown ===
[2026-01-05 11:41:47]   [FAIL] Filter-based HSTS (Target Level: high): max-age=86400; includeSubDomains=true; preload=false
[2026-01-05 11:41:47] ==============================
[2026-01-05 11:41:47] Current state: Non-compliant HSTS configuration found: 1 failed issues.
[2026-01-05 11:41:47] Configuration required: Ensuring exactly one compliant HSTS definition exists
[2026-01-05 11:41:47] Backup created: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_114147
[2026-01-05 11:41:47] DRY RUN: Would apply compliant HSTS configuration (see diff below)
--- /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml	2026-01-05 11:41:46
+++ /var/folders/8x/q59p0_c17g9czgrcs5t5yyd80000gn/T/tmp.FsiCOaRp1z	2026-01-05 11:41:47
@@ -9,7 +9,7 @@
         <filter-class>org.apache.catalina.filters.HttpHeaderSecurityFilter</filter-class>
         <init-param>
             <param-name>hstsMaxAgeSeconds</param-name>
-            <param-value>86400</param-value>
+            <param-value>31536000</param-value>
         </init-param>
         <init-param>
             <param-name>hstsIncludeSubDomains</param-name>
[2026-01-05 11:41:47] SUCCESS: DRY RUN: Would apply compliant HSTS configuration (see diff below)
[2026-01-05 11:41:47] Backup available at: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_114147
[2026-01-05 11:41:47] 
[2026-01-05 11:41:47] =========================================
[2026-01-05 11:41:47] Summary
[2026-01-05 11:41:47] =========================================
[2026-01-05 11:41:47] Total files processed: 1
[2026-01-05 11:41:47] Successful: 1
[2026-01-05 11:41:47] Failed: 0
[2026-01-05 11:41:47] Overall Status: SUCCESS
[2026-01-05 11:41:47] Log file: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/dry_run.log
[2026-01-05 11:41:47] [INFO] Dry run completed successfully
[2026-01-05 11:41:47] [INFO] Testing scenario: Non_Compliant_HSTS_No_IncludeSubDomains - HSTS with max-age correct but missing includeSubDomains (Tomcat 9.0.50)
[2026-01-05 11:41:47] [INFO] Running audit mode...
Checking Tomcat HSTS Configuration...
############################Admins-MacBook-Pro.local############################
Execution Time: 2026-01-05 11:41:47
HOSTNAME: Admins-MacBook-Pro.local
===========================

HSTS Compliance Results:
File                                     | Status          | Details
-----------------------------------------+-----------------+-----------------------------------------
web.xml                                  | Non-Compliant   | max-age=31536000, includeSubDomains=fals

===========================
Overall Status: Non-Compliant (0 Compliant, 1 Non-Compliant, 0 Not Configured)
Audit completed. Log: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/audit.log
[2026-01-05 11:41:47] [WARNING] Audit failed or found issues (this may be expected)
[2026-01-05 11:41:47] [INFO] Running configure mode (dry run)...
[2026-01-05 11:41:47] =========================================
[2026-01-05 11:41:47] Tomcat HSTS Configuration Tool
[2026-01-05 11:41:47] Hostname: Admins-MacBook-Pro.local
[2026-01-05 11:41:47] Execution Time: 2026-01-05 11:41:47
[2026-01-05 11:41:47] Mode: configure
[2026-01-05 11:41:47] =========================================
[2026-01-05 11:41:47] Checking custom configuration path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 11:41:47] Found valid Tomcat configuration at custom path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 11:41:47] Found Tomcat Configuration: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf (Version: 9.0.50)
[2026-01-05 11:41:47] Searching for web.xml files...
[2026-01-05 11:41:47]   Found: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml (global configuration)
[2026-01-05 11:41:47] Found 1 web.xml file(s) to process
[2026-01-05 11:41:47] 
[2026-01-05 11:41:47] =========================================
[2026-01-05 11:41:47] Processing: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml
[2026-01-05 11:41:47] =========================================
[2026-01-05 11:41:47] DRY RUN mode: No changes will be made
[2026-01-05 11:41:47] Found 5 HSTS header definition(s)
[2026-01-05 11:41:47] === Current Filter-Based HSTS Configuration ===
[2026-01-05 11:41:47]   hstsMaxAgeSeconds: 31536000
[2026-01-05 11:41:47]   hstsIncludeSubDomains: false
[2026-01-05 11:41:47] ===============================================
[2026-01-05 11:41:47] === Audit Result Breakdown ===
[2026-01-05 11:41:47]   [FAIL] Filter-based HSTS (Target Level: high): max-age=31536000; includeSubDomains=false; preload=false
[2026-01-05 11:41:47] ==============================
[2026-01-05 11:41:47] Current state: Non-compliant HSTS configuration found: 1 failed issues.
[2026-01-05 11:41:47] Configuration required: Ensuring exactly one compliant HSTS definition exists
[2026-01-05 11:41:47] Backup created: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_114147
[2026-01-05 11:41:47] DRY RUN: Would apply compliant HSTS configuration (see diff below)
--- /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml	2026-01-05 11:41:47
+++ /var/folders/8x/q59p0_c17g9czgrcs5t5yyd80000gn/T/tmp.whXL7kPgOu	2026-01-05 11:41:47
@@ -13,7 +13,7 @@
         </init-param>
         <init-param>
             <param-name>hstsIncludeSubDomains</param-name>
-            <param-value>false</param-value>
+            <param-value>true</param-value>
         </init-param>
     </filter>
     <filter-mapping>
[2026-01-05 11:41:47] SUCCESS: DRY RUN: Would apply compliant HSTS configuration (see diff below)
[2026-01-05 11:41:47] Backup available at: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_114147
[2026-01-05 11:41:47] 
[2026-01-05 11:41:47] =========================================
[2026-01-05 11:41:47] Summary
[2026-01-05 11:41:47] =========================================
[2026-01-05 11:41:47] Total files processed: 1
[2026-01-05 11:41:47] Successful: 1
[2026-01-05 11:41:47] Failed: 0
[2026-01-05 11:41:47] Overall Status: SUCCESS
[2026-01-05 11:41:47] Log file: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/dry_run.log
[2026-01-05 11:41:47] [INFO] Dry run completed successfully
[2026-01-05 11:41:47] [INFO] Testing scenario: Compliant_HSTS - Already compliant HSTS configuration (Tomcat 9.0.50)
[2026-01-05 11:41:47] [INFO] Running audit mode...
Checking Tomcat HSTS Configuration...
############################Admins-MacBook-Pro.local############################
Execution Time: 2026-01-05 11:41:47
HOSTNAME: Admins-MacBook-Pro.local
===========================

HSTS Compliance Results:
File                                     | Status          | Details
-----------------------------------------+-----------------+-----------------------------------------
web.xml                                  | Compliant       | max-age=31536000, includeSubDomains=true

===========================
Overall Status: Compliant (1 Compliant)
Audit completed. Log: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/audit.log
[2026-01-05 11:41:47] [INFO] Audit completed successfully
[2026-01-05 11:41:47] [INFO] Running configure mode (dry run)...
[2026-01-05 11:41:47] =========================================
[2026-01-05 11:41:47] Tomcat HSTS Configuration Tool
[2026-01-05 11:41:47] Hostname: Admins-MacBook-Pro.local
[2026-01-05 11:41:47] Execution Time: 2026-01-05 11:41:47
[2026-01-05 11:41:47] Mode: configure
[2026-01-05 11:41:47] =========================================
[2026-01-05 11:41:47] Checking custom configuration path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 11:41:47] Found valid Tomcat configuration at custom path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 11:41:47] Found Tomcat Configuration: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf (Version: 9.0.50)
[2026-01-05 11:41:47] Searching for web.xml files...
[2026-01-05 11:41:47]   Found: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml (global configuration)
[2026-01-05 11:41:47] Found 1 web.xml file(s) to process
[2026-01-05 11:41:47] 
[2026-01-05 11:41:47] =========================================
[2026-01-05 11:41:47] Processing: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml
[2026-01-05 11:41:47] =========================================
[2026-01-05 11:41:47] DRY RUN mode: No changes will be made
[2026-01-05 11:41:48] Found 5 HSTS header definition(s)
[2026-01-05 11:41:48] === Current Filter-Based HSTS Configuration ===
[2026-01-05 11:41:48]   hstsMaxAgeSeconds: 31536000
[2026-01-05 11:41:48]   hstsIncludeSubDomains: true
[2026-01-05 11:41:48] ===============================================
[2026-01-05 11:41:48] === Audit Result Breakdown ===
[2026-01-05 11:41:48]   [PASS] Filter-based HSTS (Level: high): max-age=31536000; includeSubDomains=true; preload=false
[2026-01-05 11:41:48] ==============================
[2026-01-05 11:41:48] Current state: HSTS is correctly configured with exactly one compliant definition.
[2026-01-05 11:41:48] SUCCESS: HSTS is already correctly configured with exactly one compliant definition
[2026-01-05 11:41:48] 
[2026-01-05 11:41:48] =========================================
[2026-01-05 11:41:48] Summary
[2026-01-05 11:41:48] =========================================
[2026-01-05 11:41:48] Total files processed: 1
[2026-01-05 11:41:48] Successful: 1
[2026-01-05 11:41:48] Failed: 0
[2026-01-05 11:41:48] Overall Status: SUCCESS
[2026-01-05 11:41:48] Log file: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/dry_run.log
[2026-01-05 11:41:48] [INFO] Dry run completed successfully
[2026-01-05 11:41:48] [INFO] Testing scenario: Tomcat_11_Jakarta - Tomcat 11 with jakarta.ee namespace (Tomcat 11.0.0)
[2026-01-05 11:41:48] [INFO] Running audit mode...
Checking Tomcat HSTS Configuration...
############################Admins-MacBook-Pro.local############################
Execution Time: 2026-01-05 11:41:48
HOSTNAME: Admins-MacBook-Pro.local
===========================

HSTS Compliance Results:
File                                     | Status          | Details
-----------------------------------------+-----------------+-----------------------------------------
web.xml                                  | Not Configured  | No HSTS filters found

===========================
Overall Status: Non-Compliant (0 Compliant, 0 Non-Compliant, 1 Not Configured)
Audit completed. Log: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/audit.log
[2026-01-05 11:41:48] [WARNING] Audit failed or found issues (this may be expected)
[2026-01-05 11:41:48] [INFO] Running configure mode (dry run)...
[2026-01-05 11:41:48] =========================================
[2026-01-05 11:41:48] Tomcat HSTS Configuration Tool
[2026-01-05 11:41:48] Hostname: Admins-MacBook-Pro.local
[2026-01-05 11:41:48] Execution Time: 2026-01-05 11:41:48
[2026-01-05 11:41:48] Mode: configure
[2026-01-05 11:41:48] =========================================
[2026-01-05 11:41:48] Checking custom configuration path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 11:41:48] Found valid Tomcat configuration at custom path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 11:41:48] Found Tomcat Configuration: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf (Version: 11.0.0)
[2026-01-05 11:41:48] Searching for web.xml files...
[2026-01-05 11:41:48]   Found: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml (global configuration)
[2026-01-05 11:41:48] Found 1 web.xml file(s) to process
[2026-01-05 11:41:48] 
[2026-01-05 11:41:48] =========================================
[2026-01-05 11:41:48] Processing: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml
[2026-01-05 11:41:48] =========================================
[2026-01-05 11:41:48] DRY RUN mode: No changes will be made
[2026-01-05 11:41:48] === AUDIT: No HSTS Configuration Found ===
[2026-01-05 11:41:48] No HSTS headers or filters detected in the configuration file.
[2026-01-05 11:41:48] 
[2026-01-05 11:41:48] Configuration Context:
[2026-01-05 11:41:48]   No filters found in configuration
[2026-01-05 11:41:48] 
[2026-01-05 11:41:48] === Current HSTS Configuration ===
[2026-01-05 11:41:48]   Status: NOT CONFIGURED
[2026-01-05 11:41:48]   Header: (none)
[2026-01-05 11:41:48] 
[2026-01-05 11:41:48] === Available Security Levels ===
[2026-01-05 11:41:48] 
[2026-01-05 11:41:48]   [1] BASIC - Minimum HSTS protection
[2026-01-05 11:41:48]       Header: Strict-Transport-Security: max-age=31536000
[2026-01-05 11:41:48]       Use when: Subdomains should NOT be affected
[2026-01-05 11:41:48] 
[2026-01-05 11:41:48]   [2] HIGH - OWASP Recommended (Default)
[2026-01-05 11:41:48]       Header: Strict-Transport-Security: max-age=31536000; includeSubDomains
[2026-01-05 11:41:48]       Use when: All subdomains also use HTTPS
[2026-01-05 11:41:48] 
[2026-01-05 11:41:48]   [3] VERY HIGH - Preload Ready
[2026-01-05 11:41:48]       Header: Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
[2026-01-05 11:41:48]       Use when: Ready for browser preload list submission
[2026-01-05 11:41:48] 
[2026-01-05 11:41:48]   [4] MAXIMUM - Highest Security
[2026-01-05 11:41:48]       Header: Strict-Transport-Security: max-age=63072000; includeSubDomains; preload
[2026-01-05 11:41:48]       Use when: Maximum protection with 2-year cache
[2026-01-05 11:41:48] 
[2026-01-05 11:41:48] === Configure Commands (copy and run) ===
[2026-01-05 11:41:48] 
[2026-01-05 11:41:48]   Option 1: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level basic
[2026-01-05 11:41:48]   Option 2: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level high
[2026-01-05 11:41:48]   Option 3: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level veryhigh
[2026-01-05 11:41:48]   Option 4: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level maximum
[2026-01-05 11:41:48] 
[2026-01-05 11:41:48]   Add --dry-run to preview changes without applying
[2026-01-05 11:41:48] ==========================================
[2026-01-05 11:41:48] Current state: No HSTS header definitions found in configuration
[2026-01-05 11:41:48] Configuration required: Ensuring exactly one compliant HSTS definition exists
[2026-01-05 11:41:48] Backup created: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_114148
[2026-01-05 11:41:48] DRY RUN: Would apply compliant HSTS configuration (see diff below)
--- /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml	2026-01-05 11:41:48
+++ /var/folders/8x/q59p0_c17g9czgrcs5t5yyd80000gn/T/tmp.O8rzsq7zzI	2026-01-05 11:41:48
@@ -5,4 +5,20 @@
          https://jakarta.ee/xml/ns/jakartaee/web-app_5_0.xsd"
          version="5.0">
     <display-name>Jakarta Test App</display-name>
+    <filter>
+        <filter-name>HstsHeaderFilter</filter-name>
+        <filter-class>org.apache.catalina.filters.HttpHeaderSecurityFilter</filter-class>
+        <init-param>
+            <param-name>hstsMaxAgeSeconds</param-name>
+            <param-value>31536000</param-value>
+        </init-param>
+        <init-param>
+            <param-name>hstsIncludeSubDomains</param-name>
+            <param-value>true</param-value>
+        </init-param>
+    </filter>
+    <filter-mapping>
+        <filter-name>HstsHeaderFilter</filter-name>
+        <url-pattern>/*</url-pattern>
+    </filter-mapping>
 </web-app>
[2026-01-05 11:41:48] SUCCESS: DRY RUN: Would apply compliant HSTS configuration (see diff below)
[2026-01-05 11:41:48] Backup available at: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_114148
[2026-01-05 11:41:48] 
[2026-01-05 11:41:48] =========================================
[2026-01-05 11:41:48] Summary
[2026-01-05 11:41:48] =========================================
[2026-01-05 11:41:48] Total files processed: 1
[2026-01-05 11:41:48] Successful: 1
[2026-01-05 11:41:48] Failed: 0
[2026-01-05 11:41:48] Overall Status: SUCCESS
[2026-01-05 11:41:48] Log file: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/dry_run.log
[2026-01-05 11:41:48] [INFO] Dry run completed successfully
[2026-01-05 11:41:48] [INFO] Testing scenario: JSON_Reporting - Verify JSON output format
[2026-01-05 11:41:48] [INFO] Running with --json flag...
[2026-01-05 11:41:48] [INFO] JSON output format verified successfully
[2026-01-05 11:41:48] [INFO] JSON Content: {"hostname":"Admins-MacBook-Pro.local","os":"Darwin 24.3.0","timestamp":"2026-01-05 11:41:48","mode":"audit","total_processed":1,"success_count":0,"failure_count":1,"overall_status":"FAILURE"}
[2026-01-05 11:41:48] [INFO] === All HSTS tests completed ===
[2026-01-05 11:41:48] [INFO] Test log saved to: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/TestHstsUnix.log
[2026-01-05 11:41:48] [INFO] Test files saved to: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest
[2026-01-05 11:41:48] [INFO] Backups saved to: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTestBackup
[2026-01-05 11:46:51] [INFO] Starting HSTS patching tests for Unix/Linux...
[2026-01-05 11:46:51] [INFO] Testing scenario: No_HSTS_Header - Configuration with no HSTS header (Tomcat 9.0.50)
[2026-01-05 11:46:51] [INFO] Running audit mode...
Checking Tomcat HSTS Configuration...
###############################MacBookPro.station###############################
Execution Time: 2026-01-05 11:46:51
HOSTNAME: MacBookPro.station
===========================

HSTS Compliance Results:
File                                     | Status          | Details
-----------------------------------------+-----------------+-----------------------------------------
web.xml                                  | Not Configured  | No HSTS filters found

===========================
Overall Status: Non-Compliant (0 Compliant, 0 Non-Compliant, 1 Not Configured)
Audit completed. Log: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/audit.log
[2026-01-05 11:46:51] [WARNING] Audit failed or found issues (this may be expected)
[2026-01-05 11:46:51] [INFO] Running configure mode (dry run)...
[2026-01-05 11:46:51] =========================================
[2026-01-05 11:46:51] Tomcat HSTS Configuration Tool
[2026-01-05 11:46:51] Hostname: MacBookPro.station
[2026-01-05 11:46:51] Execution Time: 2026-01-05 11:46:51
[2026-01-05 11:46:51] Mode: configure
[2026-01-05 11:46:51] =========================================
[2026-01-05 11:46:51] Checking custom configuration path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 11:46:51] Found valid Tomcat configuration at custom path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 11:46:51] Found Tomcat Configuration: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf (Version: 9.0.50)
[2026-01-05 11:46:51] Searching for web.xml files...
[2026-01-05 11:46:51]   Found: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml (global configuration)
[2026-01-05 11:46:51] Found 1 web.xml file(s) to process
[2026-01-05 11:46:51] 
[2026-01-05 11:46:51] =========================================
[2026-01-05 11:46:51] Processing: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml
[2026-01-05 11:46:51] =========================================
[2026-01-05 11:46:51] DRY RUN mode: No changes will be made
[2026-01-05 11:46:51] === AUDIT: No HSTS Configuration Found ===
[2026-01-05 11:46:51] No HSTS headers or filters detected in the configuration file.
[2026-01-05 11:46:51] 
[2026-01-05 11:46:51] Configuration Context:
[2026-01-05 11:46:51]   No filters found in configuration
[2026-01-05 11:46:51] 
[2026-01-05 11:46:51] === Current HSTS Configuration ===
[2026-01-05 11:46:51]   Status: NOT CONFIGURED
[2026-01-05 11:46:51]   Header: (none)
[2026-01-05 11:46:51] 
[2026-01-05 11:46:51] === Available Security Levels ===
[2026-01-05 11:46:51] 
[2026-01-05 11:46:51]   [1] BASIC - Minimum HSTS protection
[2026-01-05 11:46:51]       Header: Strict-Transport-Security: max-age=31536000
[2026-01-05 11:46:51]       Use when: Subdomains should NOT be affected
[2026-01-05 11:46:51] 
[2026-01-05 11:46:51]   [2] HIGH - OWASP Recommended (Default)
[2026-01-05 11:46:51]       Header: Strict-Transport-Security: max-age=31536000; includeSubDomains
[2026-01-05 11:46:51]       Use when: All subdomains also use HTTPS
[2026-01-05 11:46:51] 
[2026-01-05 11:46:51]   [3] VERY HIGH - Preload Ready
[2026-01-05 11:46:51]       Header: Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
[2026-01-05 11:46:51]       Use when: Ready for browser preload list submission
[2026-01-05 11:46:51] 
[2026-01-05 11:46:51]   [4] MAXIMUM - Highest Security
[2026-01-05 11:46:51]       Header: Strict-Transport-Security: max-age=63072000; includeSubDomains; preload
[2026-01-05 11:46:51]       Use when: Maximum protection with 2-year cache
[2026-01-05 11:46:51] 
[2026-01-05 11:46:51] === Configure Commands (copy and run) ===
[2026-01-05 11:46:51] 
[2026-01-05 11:46:51]   Option 1: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level basic
[2026-01-05 11:46:51]   Option 2: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level high
[2026-01-05 11:46:51]   Option 3: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level veryhigh
[2026-01-05 11:46:51]   Option 4: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level maximum
[2026-01-05 11:46:51] 
[2026-01-05 11:46:51]   Add --dry-run to preview changes without applying
[2026-01-05 11:46:51] ==========================================
[2026-01-05 11:46:51] Current state: No HSTS header definitions found in configuration
[2026-01-05 11:46:51] Configuration required: Ensuring exactly one compliant HSTS definition exists
[2026-01-05 11:46:51] Backup created: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_114651
[2026-01-05 11:46:51] DRY RUN: Would apply compliant HSTS configuration (see diff below)
--- /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml	2026-01-05 11:46:51
+++ /var/folders/8x/q59p0_c17g9czgrcs5t5yyd80000gn/T/tmp.WAmaoh3AAN	2026-01-05 11:46:51
@@ -5,4 +5,20 @@
          http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"
          version="4.0">
     <display-name>Test Application</display-name>
+    <filter>
+        <filter-name>HstsHeaderFilter</filter-name>
+        <filter-class>org.apache.catalina.filters.HttpHeaderSecurityFilter</filter-class>
+        <init-param>
+            <param-name>hstsMaxAgeSeconds</param-name>
+            <param-value>31536000</param-value>
+        </init-param>
+        <init-param>
+            <param-name>hstsIncludeSubDomains</param-name>
+            <param-value>true</param-value>
+        </init-param>
+    </filter>
+    <filter-mapping>
+        <filter-name>HstsHeaderFilter</filter-name>
+        <url-pattern>/*</url-pattern>
+    </filter-mapping>
 </web-app>
[2026-01-05 11:46:51] SUCCESS: DRY RUN: Would apply compliant HSTS configuration (see diff below)
[2026-01-05 11:46:51] Backup available at: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_114651
[2026-01-05 11:46:51] 
[2026-01-05 11:46:51] =========================================
[2026-01-05 11:46:51] Summary
[2026-01-05 11:46:51] =========================================
[2026-01-05 11:46:51] Total files processed: 1
[2026-01-05 11:46:51] Successful: 1
[2026-01-05 11:46:51] Failed: 0
[2026-01-05 11:46:51] Overall Status: SUCCESS
[2026-01-05 11:46:51] Log file: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/dry_run.log
[2026-01-05 11:46:51] [INFO] Dry run completed successfully
[2026-01-05 11:46:51] [INFO] Testing scenario: Non_Compliant_HSTS_Short_MaxAge - HSTS with max-age less than 31536000 (Tomcat 9.0.50)
[2026-01-05 11:46:51] [INFO] Running audit mode...
Checking Tomcat HSTS Configuration...
###############################MacBookPro.station###############################
Execution Time: 2026-01-05 11:46:51
HOSTNAME: MacBookPro.station
===========================

HSTS Compliance Results:
File                                     | Status          | Details
-----------------------------------------+-----------------+-----------------------------------------
web.xml                                  | Non-Compliant   | max-age=86400, includeSubDomains=true

===========================
Overall Status: Non-Compliant (0 Compliant, 1 Non-Compliant, 0 Not Configured)
Audit completed. Log: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/audit.log
[2026-01-05 11:46:51] [WARNING] Audit failed or found issues (this may be expected)
[2026-01-05 11:46:51] [INFO] Running configure mode (dry run)...
[2026-01-05 11:46:51] =========================================
[2026-01-05 11:46:51] Tomcat HSTS Configuration Tool
[2026-01-05 11:46:51] Hostname: MacBookPro.station
[2026-01-05 11:46:51] Execution Time: 2026-01-05 11:46:51
[2026-01-05 11:46:51] Mode: configure
[2026-01-05 11:46:51] =========================================
[2026-01-05 11:46:51] Checking custom configuration path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 11:46:51] Found valid Tomcat configuration at custom path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 11:46:51] Found Tomcat Configuration: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf (Version: 9.0.50)
[2026-01-05 11:46:51] Searching for web.xml files...
[2026-01-05 11:46:51]   Found: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml (global configuration)
[2026-01-05 11:46:51] Found 1 web.xml file(s) to process
[2026-01-05 11:46:51] 
[2026-01-05 11:46:51] =========================================
[2026-01-05 11:46:51] Processing: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml
[2026-01-05 11:46:51] =========================================
[2026-01-05 11:46:51] DRY RUN mode: No changes will be made
[2026-01-05 11:46:52] Found 5 HSTS header definition(s)
[2026-01-05 11:46:52] === Current Filter-Based HSTS Configuration ===
[2026-01-05 11:46:52]   hstsMaxAgeSeconds: 86400
[2026-01-05 11:46:52]   hstsIncludeSubDomains: true
[2026-01-05 11:46:52] ===============================================
[2026-01-05 11:46:52] === Audit Result Breakdown ===
[2026-01-05 11:46:52]   [FAIL] Filter-based HSTS (Target Level: high): max-age=86400; includeSubDomains=true; preload=false
[2026-01-05 11:46:52] ==============================
[2026-01-05 11:46:52] Current state: Non-compliant HSTS configuration found: 1 failed issues.
[2026-01-05 11:46:52] Configuration required: Ensuring exactly one compliant HSTS definition exists
[2026-01-05 11:46:52] Backup created: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_114652
[2026-01-05 11:46:52] DRY RUN: Would apply compliant HSTS configuration (see diff below)
--- /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml	2026-01-05 11:46:51
+++ /var/folders/8x/q59p0_c17g9czgrcs5t5yyd80000gn/T/tmp.cfiJLIHZls	2026-01-05 11:46:52
@@ -9,7 +9,7 @@
         <filter-class>org.apache.catalina.filters.HttpHeaderSecurityFilter</filter-class>
         <init-param>
             <param-name>hstsMaxAgeSeconds</param-name>
-            <param-value>86400</param-value>
+            <param-value>31536000</param-value>
         </init-param>
         <init-param>
             <param-name>hstsIncludeSubDomains</param-name>
[2026-01-05 11:46:52] SUCCESS: DRY RUN: Would apply compliant HSTS configuration (see diff below)
[2026-01-05 11:46:52] Backup available at: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_114652
[2026-01-05 11:46:52] 
[2026-01-05 11:46:52] =========================================
[2026-01-05 11:46:52] Summary
[2026-01-05 11:46:52] =========================================
[2026-01-05 11:46:52] Total files processed: 1
[2026-01-05 11:46:52] Successful: 1
[2026-01-05 11:46:52] Failed: 0
[2026-01-05 11:46:52] Overall Status: SUCCESS
[2026-01-05 11:46:52] Log file: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/dry_run.log
[2026-01-05 11:46:52] [INFO] Dry run completed successfully
[2026-01-05 11:46:52] [INFO] Testing scenario: Non_Compliant_HSTS_No_IncludeSubDomains - HSTS with max-age correct but missing includeSubDomains (Tomcat 9.0.50)
[2026-01-05 11:46:52] [INFO] Running audit mode...
Checking Tomcat HSTS Configuration...
###############################MacBookPro.station###############################
Execution Time: 2026-01-05 11:46:52
HOSTNAME: MacBookPro.station
===========================

HSTS Compliance Results:
File                                     | Status          | Details
-----------------------------------------+-----------------+-----------------------------------------
web.xml                                  | Non-Compliant   | max-age=31536000, includeSubDomains=fals

===========================
Overall Status: Non-Compliant (0 Compliant, 1 Non-Compliant, 0 Not Configured)
Audit completed. Log: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/audit.log
[2026-01-05 11:46:52] [WARNING] Audit failed or found issues (this may be expected)
[2026-01-05 11:46:52] [INFO] Running configure mode (dry run)...
[2026-01-05 11:46:52] =========================================
[2026-01-05 11:46:52] Tomcat HSTS Configuration Tool
[2026-01-05 11:46:52] Hostname: MacBookPro.station
[2026-01-05 11:46:52] Execution Time: 2026-01-05 11:46:52
[2026-01-05 11:46:52] Mode: configure
[2026-01-05 11:46:52] =========================================
[2026-01-05 11:46:52] Checking custom configuration path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 11:46:52] Found valid Tomcat configuration at custom path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 11:46:52] Found Tomcat Configuration: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf (Version: 9.0.50)
[2026-01-05 11:46:52] Searching for web.xml files...
[2026-01-05 11:46:52]   Found: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml (global configuration)
[2026-01-05 11:46:52] Found 1 web.xml file(s) to process
[2026-01-05 11:46:52] 
[2026-01-05 11:46:52] =========================================
[2026-01-05 11:46:52] Processing: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml
[2026-01-05 11:46:52] =========================================
[2026-01-05 11:46:52] DRY RUN mode: No changes will be made
[2026-01-05 11:46:52] Found 5 HSTS header definition(s)
[2026-01-05 11:46:52] === Current Filter-Based HSTS Configuration ===
[2026-01-05 11:46:52]   hstsMaxAgeSeconds: 31536000
[2026-01-05 11:46:52]   hstsIncludeSubDomains: false
[2026-01-05 11:46:52] ===============================================
[2026-01-05 11:46:52] === Audit Result Breakdown ===
[2026-01-05 11:46:52]   [FAIL] Filter-based HSTS (Target Level: high): max-age=31536000; includeSubDomains=false; preload=false
[2026-01-05 11:46:52] ==============================
[2026-01-05 11:46:52] Current state: Non-compliant HSTS configuration found: 1 failed issues.
[2026-01-05 11:46:52] Configuration required: Ensuring exactly one compliant HSTS definition exists
[2026-01-05 11:46:52] Backup created: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_114652
[2026-01-05 11:46:52] DRY RUN: Would apply compliant HSTS configuration (see diff below)
--- /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml	2026-01-05 11:46:52
+++ /var/folders/8x/q59p0_c17g9czgrcs5t5yyd80000gn/T/tmp.2aFEOPTadW	2026-01-05 11:46:52
@@ -13,7 +13,7 @@
         </init-param>
         <init-param>
             <param-name>hstsIncludeSubDomains</param-name>
-            <param-value>false</param-value>
+            <param-value>true</param-value>
         </init-param>
     </filter>
     <filter-mapping>
[2026-01-05 11:46:52] SUCCESS: DRY RUN: Would apply compliant HSTS configuration (see diff below)
[2026-01-05 11:46:52] Backup available at: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_114652
[2026-01-05 11:46:52] 
[2026-01-05 11:46:52] =========================================
[2026-01-05 11:46:52] Summary
[2026-01-05 11:46:52] =========================================
[2026-01-05 11:46:52] Total files processed: 1
[2026-01-05 11:46:52] Successful: 1
[2026-01-05 11:46:52] Failed: 0
[2026-01-05 11:46:52] Overall Status: SUCCESS
[2026-01-05 11:46:52] Log file: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/dry_run.log
[2026-01-05 11:46:52] [INFO] Dry run completed successfully
[2026-01-05 11:46:52] [INFO] Testing scenario: Compliant_HSTS - Already compliant HSTS configuration (Tomcat 9.0.50)
[2026-01-05 11:46:52] [INFO] Running audit mode...
Checking Tomcat HSTS Configuration...
###############################MacBookPro.station###############################
Execution Time: 2026-01-05 11:46:52
HOSTNAME: MacBookPro.station
===========================

HSTS Compliance Results:
File                                     | Status          | Details
-----------------------------------------+-----------------+-----------------------------------------
web.xml                                  | Compliant       | max-age=31536000, includeSubDomains=true

===========================
Overall Status: Compliant (1 Compliant)
Audit completed. Log: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/audit.log
[2026-01-05 11:46:52] [INFO] Audit completed successfully
[2026-01-05 11:46:52] [INFO] Running configure mode (dry run)...
[2026-01-05 11:46:52] =========================================
[2026-01-05 11:46:52] Tomcat HSTS Configuration Tool
[2026-01-05 11:46:52] Hostname: MacBookPro.station
[2026-01-05 11:46:52] Execution Time: 2026-01-05 11:46:52
[2026-01-05 11:46:52] Mode: configure
[2026-01-05 11:46:52] =========================================
[2026-01-05 11:46:52] Checking custom configuration path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 11:46:52] Found valid Tomcat configuration at custom path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 11:46:52] Found Tomcat Configuration: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf (Version: 9.0.50)
[2026-01-05 11:46:52] Searching for web.xml files...
[2026-01-05 11:46:52]   Found: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml (global configuration)
[2026-01-05 11:46:52] Found 1 web.xml file(s) to process
[2026-01-05 11:46:52] 
[2026-01-05 11:46:52] =========================================
[2026-01-05 11:46:52] Processing: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml
[2026-01-05 11:46:52] =========================================
[2026-01-05 11:46:52] DRY RUN mode: No changes will be made
[2026-01-05 11:46:53] Found 5 HSTS header definition(s)
[2026-01-05 11:46:53] === Current Filter-Based HSTS Configuration ===
[2026-01-05 11:46:53]   hstsMaxAgeSeconds: 31536000
[2026-01-05 11:46:53]   hstsIncludeSubDomains: true
[2026-01-05 11:46:53] ===============================================
[2026-01-05 11:46:53] === Audit Result Breakdown ===
[2026-01-05 11:46:53]   [PASS] Filter-based HSTS (Level: high): max-age=31536000; includeSubDomains=true; preload=false
[2026-01-05 11:46:53] ==============================
[2026-01-05 11:46:53] Current state: HSTS is correctly configured with exactly one compliant definition.
[2026-01-05 11:46:53] SUCCESS: HSTS is already correctly configured with exactly one compliant definition
[2026-01-05 11:46:53] 
[2026-01-05 11:46:53] =========================================
[2026-01-05 11:46:53] Summary
[2026-01-05 11:46:53] =========================================
[2026-01-05 11:46:53] Total files processed: 1
[2026-01-05 11:46:53] Successful: 1
[2026-01-05 11:46:53] Failed: 0
[2026-01-05 11:46:53] Overall Status: SUCCESS
[2026-01-05 11:46:53] Log file: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/dry_run.log
[2026-01-05 11:46:53] [INFO] Dry run completed successfully
[2026-01-05 11:46:53] [INFO] Testing scenario: Tomcat_11_Jakarta - Tomcat 11 with jakarta.ee namespace (Tomcat 11.0.0)
[2026-01-05 11:46:53] [INFO] Running audit mode...
Checking Tomcat HSTS Configuration...
###############################MacBookPro.station###############################
Execution Time: 2026-01-05 11:46:53
HOSTNAME: MacBookPro.station
===========================

HSTS Compliance Results:
File                                     | Status          | Details
-----------------------------------------+-----------------+-----------------------------------------
web.xml                                  | Not Configured  | No HSTS filters found

===========================
Overall Status: Non-Compliant (0 Compliant, 0 Non-Compliant, 1 Not Configured)
Audit completed. Log: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/audit.log
[2026-01-05 11:46:53] [WARNING] Audit failed or found issues (this may be expected)
[2026-01-05 11:46:53] [INFO] Running configure mode (dry run)...
[2026-01-05 11:46:53] =========================================
[2026-01-05 11:46:53] Tomcat HSTS Configuration Tool
[2026-01-05 11:46:53] Hostname: MacBookPro.station
[2026-01-05 11:46:53] Execution Time: 2026-01-05 11:46:53
[2026-01-05 11:46:53] Mode: configure
[2026-01-05 11:46:53] =========================================
[2026-01-05 11:46:53] Checking custom configuration path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 11:46:53] Found valid Tomcat configuration at custom path: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf
[2026-01-05 11:46:53] Found Tomcat Configuration: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf (Version: 11.0.0)
[2026-01-05 11:46:53] Searching for web.xml files...
[2026-01-05 11:46:53]   Found: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml (global configuration)
[2026-01-05 11:46:53] Found 1 web.xml file(s) to process
[2026-01-05 11:46:53] 
[2026-01-05 11:46:53] =========================================
[2026-01-05 11:46:53] Processing: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml
[2026-01-05 11:46:53] =========================================
[2026-01-05 11:46:53] DRY RUN mode: No changes will be made
[2026-01-05 11:46:53] === AUDIT: No HSTS Configuration Found ===
[2026-01-05 11:46:53] No HSTS headers or filters detected in the configuration file.
[2026-01-05 11:46:53] 
[2026-01-05 11:46:53] Configuration Context:
[2026-01-05 11:46:53]   No filters found in configuration
[2026-01-05 11:46:53] 
[2026-01-05 11:46:53] === Current HSTS Configuration ===
[2026-01-05 11:46:53]   Status: NOT CONFIGURED
[2026-01-05 11:46:53]   Header: (none)
[2026-01-05 11:46:53] 
[2026-01-05 11:46:53] === Available Security Levels ===
[2026-01-05 11:46:53] 
[2026-01-05 11:46:53]   [1] BASIC - Minimum HSTS protection
[2026-01-05 11:46:53]       Header: Strict-Transport-Security: max-age=31536000
[2026-01-05 11:46:53]       Use when: Subdomains should NOT be affected
[2026-01-05 11:46:53] 
[2026-01-05 11:46:53]   [2] HIGH - OWASP Recommended (Default)
[2026-01-05 11:46:53]       Header: Strict-Transport-Security: max-age=31536000; includeSubDomains
[2026-01-05 11:46:53]       Use when: All subdomains also use HTTPS
[2026-01-05 11:46:53] 
[2026-01-05 11:46:53]   [3] VERY HIGH - Preload Ready
[2026-01-05 11:46:53]       Header: Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
[2026-01-05 11:46:53]       Use when: Ready for browser preload list submission
[2026-01-05 11:46:53] 
[2026-01-05 11:46:53]   [4] MAXIMUM - Highest Security
[2026-01-05 11:46:53]       Header: Strict-Transport-Security: max-age=63072000; includeSubDomains; preload
[2026-01-05 11:46:53]       Use when: Maximum protection with 2-year cache
[2026-01-05 11:46:53] 
[2026-01-05 11:46:53] === Configure Commands (copy and run) ===
[2026-01-05 11:46:53] 
[2026-01-05 11:46:53]   Option 1: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level basic
[2026-01-05 11:46:53]   Option 2: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level high
[2026-01-05 11:46:53]   Option 3: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level veryhigh
[2026-01-05 11:46:53]   Option 4: sudo ./../../src/unix/UpdateTomcatHstsUnix.sh --mode configure --security-level maximum
[2026-01-05 11:46:53] 
[2026-01-05 11:46:53]   Add --dry-run to preview changes without applying
[2026-01-05 11:46:53] ==========================================
[2026-01-05 11:46:53] Current state: No HSTS header definitions found in configuration
[2026-01-05 11:46:53] Configuration required: Ensuring exactly one compliant HSTS definition exists
[2026-01-05 11:46:53] Backup created: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_114653
[2026-01-05 11:46:53] DRY RUN: Would apply compliant HSTS configuration (see diff below)
--- /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml	2026-01-05 11:46:53
+++ /var/folders/8x/q59p0_c17g9czgrcs5t5yyd80000gn/T/tmp.0JcqAxwefr	2026-01-05 11:46:53
@@ -5,4 +5,20 @@
          https://jakarta.ee/xml/ns/jakartaee/web-app_5_0.xsd"
          version="5.0">
     <display-name>Jakarta Test App</display-name>
+    <filter>
+        <filter-name>HstsHeaderFilter</filter-name>
+        <filter-class>org.apache.catalina.filters.HttpHeaderSecurityFilter</filter-class>
+        <init-param>
+            <param-name>hstsMaxAgeSeconds</param-name>
+            <param-value>31536000</param-value>
+        </init-param>
+        <init-param>
+            <param-name>hstsIncludeSubDomains</param-name>
+            <param-value>true</param-value>
+        </init-param>
+    </filter>
+    <filter-mapping>
+        <filter-name>HstsHeaderFilter</filter-name>
+        <url-pattern>/*</url-pattern>
+    </filter-mapping>
 </web-app>
[2026-01-05 11:46:53] SUCCESS: DRY RUN: Would apply compliant HSTS configuration (see diff below)
[2026-01-05 11:46:53] Backup available at: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/conf/web.xml.backup.20260105_114653
[2026-01-05 11:46:53] 
[2026-01-05 11:46:53] =========================================
[2026-01-05 11:46:53] Summary
[2026-01-05 11:46:53] =========================================
[2026-01-05 11:46:53] Total files processed: 1
[2026-01-05 11:46:53] Successful: 1
[2026-01-05 11:46:53] Failed: 0
[2026-01-05 11:46:53] Overall Status: SUCCESS
[2026-01-05 11:46:53] Log file: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest/dry_run.log
[2026-01-05 11:46:53] [INFO] Dry run completed successfully
[2026-01-05 11:46:53] [INFO] Testing scenario: JSON_Reporting - Verify JSON output format
[2026-01-05 11:46:53] [INFO] Running with --json flag...
[2026-01-05 11:46:53] [INFO] JSON output format verified successfully
[2026-01-05 11:46:53] [INFO] JSON Content: {"hostname":"MacBookPro.station","os":"Darwin 24.3.0","timestamp":"2026-01-05 11:46:53","mode":"audit","total_processed":1,"success_count":0,"failure_count":1,"overall_status":"FAILURE"}
[2026-01-05 11:46:53] [INFO] === All HSTS tests completed ===
[2026-01-05 11:46:53] [INFO] Test log saved to: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/TestHstsUnix.log
[2026-01-05 11:46:53] [INFO] Test files saved to: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTest
[2026-01-05 11:46:53] [INFO] Backups saved to: /Users/admin/Documents/HSTS_Compliance_Apache-Tomcat_IIS/tests/unix/tests/HstsTestBackup
